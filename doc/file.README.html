<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf8" />
<title>Fogli Documentation</title>
<link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html" title="Index">Index</a> &raquo; 
    <span class="title">File: README</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><div id='filecontents'><h1>Fogli</h1>

<p>Fogli is a <strong>F</strong>acebook <strong>O</strong>pen <strong>G</strong>raph <strong>Li</strong>brary.</p>

<h2>Why?</h2>

<p>Facebook introduced the Graph API in April, 2010. This API is intended
to replace their existing "RESTful API" in the future. Mature Facebook
libraries such as <a href="http://github.com/mmangino/facebooker">Facebooker</a> are
heavily tied to the RESTful API and have not started supporting the Open
Graph.</p>

<p>At the time of Fogli's creation, there were a handful of other libraries
claiming to be Facebook Graph libraries, but I found them unsatisfactory
since they did not meet any or all of the following requirements:</p>

<ul>
<li>Minimizes query calls</li>
<li>Strong feature support</li>
<li>Intuitive object model</li>
<li>Independent library; not tied to any web framework</li>
</ul>


<p>Fogli aims to expose the objects of the Facebook Graph through an intuitive
object oriented interface while minimizing the number of queries needed
to access data through lazy loading and caching. Fogli is not tied to any
web framework and can run standalone perfectly fine.</p>

<h2>Supported Features</h2>

<p>Below is a list of supported Facebook Graph features:</p>

<ul>
<li>Authorization via OAuth</li>
<li>Reading objects (<code>User</code>, <code>Page</code>, etc.)</li>
<li>Reading object connections</li>
<li>Deleting objects</li>
<li>Scoping top level objects by <code>fields</code></li>
<li>Scoping connections by <code>limit</code>, <code>offset</code>, <code>since</code>, <code>until</code>, and <code>fields</code></li>
<li>Liking/unliking posts</li>
</ul>


<p>The list below is a list of unsupported features, but development is
planned in the near future:</p>

<ul>
<li>More support for publishing (posting comments, attending events, etc.)</li>
<li>Search</li>
<li>Real time updates</li>
<li>Analytics</li>
</ul>


<p>Have a feature request? Submit it on the <a href="https://github.com/mitchellh/fogli/issues">GitHub Issues</a>
page, or fork and send me a patch!</p>

<h2>Getting Started</h2>

<p>Install Fogli:</p>

<pre class="code"><span class='gem identifier id'>gem</span> <span class='install identifier id'>install</span> <span class='fogli identifier id'>fogli</span>
</pre>

<p>Next, you can do a few things:</p>

<ul>
<li><p>Open an IRB session and begin playing. Fogli isn't tied to any framework,
so you can see it work right away:</p>

<pre class="code"><span class='rshft op'>&gt;&gt;</span> <span class='require identifier id'>require</span> <span class='string val'>&quot;fogli&quot;</span>
<span class='rshft op'>&gt;&gt;</span> <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='Fogli constant id'>Fogli</span><span class='colon2 op'>::</span><span class='User constant id'>User</span><span class='lbrack token'>[</span><span class='string val'>&quot;mitchellh&quot;</span><span class='rbrack token'>]</span>
<span class='rshft op'>&gt;&gt;</span> <span class='m identifier id'>m</span><span class='dot token'>.</span><span class='name identifier id'>name</span>
<span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Mitchell Hashimoto&quot;</span>
</pre></li>
<li><p>Run the examples in the <code>examples/</code> directory to see how to access basic
connections and also use <tt><a href="Fogli/OAuth.html" title="Fogli::OAuth (class)">OAuth</a></tt> to access authorized data.</p></li>
<li><p>Read the documentation here!</p></li>
</ul>


<h2>Reading Data and Accessing Connections</h2>

<p>Reading public information is straightforward and requires no configuration:</p>

<pre class="code"><span class='u identifier id'>u</span> <span class='assign token'>=</span> <span class='Fogli constant id'>Fogli</span><span class='colon2 op'>::</span><span class='User constant id'>User</span><span class='lbrack token'>[</span><span class='string val'>&quot;mitchellh&quot;</span><span class='rbrack token'>]</span>
<span class='p identifier id'>p</span> <span class='u identifier id'>u</span><span class='dot token'>.</span><span class='first_name identifier id'>first_name</span> <span class='comment val'># &quot;Mitchell&quot;</span>
<span class='p identifier id'>p</span> <span class='u identifier id'>u</span><span class='dot token'>.</span><span class='last_name identifier id'>last_name</span>  <span class='comment val'># &quot;Hashimoto&quot;</span>
</pre>

<p>Accessing connections (relationships to data) is also intuitive and
easy:</p>

<pre class="code"><span class='u identifier id'>u</span><span class='dot token'>.</span><span class='feed identifier id'>feed</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='item identifier id'>item</span><span class='bitor op'>|</span>
  <span class='p identifier id'>p</span> <span class='item identifier id'>item</span>
<span class='end end kw'>end</span>
</pre>

<h2>Authentication, Authorization, and Accessing Private Data</h2>

<p>To access private data, Facebook requires that the you gain an <code>access_token</code>
by asking the user to authorize your application. This is a two-step process.
The example before uses <a href="http://www.sinatrarb.com/">Sinatra</a> with Fogli to
authorize a user and print his or her email:</p>

<pre class="code"><span class='comment val'># Set these configuration values. The keys are retrieved from</span>
<span class='comment val'># registering an application with Facebook. These can all be</span>
<span class='comment val'># set on the actual method calls later as well.</span>
<span class='Fogli constant id'>Fogli</span><span class='dot token'>.</span><span class='client_id identifier id'>client_id</span> <span class='assign token'>=</span> <span class='string val'>&quot;...&quot;</span>
<span class='Fogli constant id'>Fogli</span><span class='dot token'>.</span><span class='client_secret identifier id'>client_secret</span> <span class='assign token'>=</span> <span class='string val'>&quot;...&quot;</span>
<span class='Fogli constant id'>Fogli</span><span class='dot token'>.</span><span class='redirect_uri identifier id'>redirect_uri</span> <span class='assign token'>=</span> <span class='string val'>&quot;http://my-website.com/verify&quot;</span>

<span class='get identifier id'>get</span> <span class='string val'>&quot;/&quot;</span> <span class='do do kw'>do</span>
  <span class='comment val'># Redirect the user to authorized, asking for email permissions</span>
  <span class='redirect identifier id'>redirect</span> <span class='Fogli constant id'>Fogli</span><span class='colon2 op'>::</span><span class='OAuth constant id'>OAuth</span><span class='dot token'>.</span><span class='authorize identifier id'>authorize</span><span class='lparen token'>(</span><span class='symbol val'>:scope</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;email&quot;</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>

<span class='get identifier id'>get</span> <span class='string val'>&quot;/verify&quot;</span>
  <span class='comment val'># Facebook redirects back to this page with a GET parameter `code`</span>
  <span class='comment val'># which is used to get the access token. This token should also be</span>
  <span class='comment val'># stored in a cookie or some session storage to be set on subsequent pages.</span>
  <span class='Fogli constant id'>Fogli</span><span class='dot token'>.</span><span class='access_token identifier id'>access_token</span> <span class='assign token'>=</span> <span class='Fogli constant id'>Fogli</span><span class='colon2 op'>::</span><span class='OAuth constant id'>OAuth</span><span class='dot token'>.</span><span class='access_token identifier id'>access_token</span><span class='lparen token'>(</span><span class='symbol val'>:code</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:code</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

  <span class='comment val'># Print authorized data to prove we're allowed!</span>
  <span class='Fogli constant id'>Fogli</span><span class='colon2 op'>::</span><span class='User constant id'>User</span><span class='lbrack token'>[</span><span class='symbol val'>:me</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='email identifier id'>email</span>
<span class='end end kw'>end</span>
</pre>

<p>Checking if a user is already authenciated is easy as well:</p>

<pre class="code"><span class='comment val'># Set from cookies, perhaps</span>
<span class='Fogli constant id'>Fogli</span><span class='dot token'>.</span><span class='access_token identifier id'>access_token</span> <span class='assign token'>=</span> <span class='cookies identifier id'>cookies</span><span class='lbrack token'>[</span><span class='symbol val'>:access_token</span><span class='rbrack token'>]</span>

<span class='comment val'># Verify its valid</span>
<span class='if if kw'>if</span> <span class='Fogli constant id'>Fogli</span><span class='colon2 op'>::</span><span class='User constant id'>User</span><span class='dot token'>.</span><span class='authorized? fid id'>authorized?</span>
  <span class='comment val'># valid!</span>
<span class='else else kw'>else</span>
  <span class='comment val'># reauthenticate</span>
<span class='end end kw'>end</span>
</pre>

<h2>Accessing Connections with Scopes</h2>

<p>Facebook data connections are typically relationships to massive amounts
of data, most of which you're not interested in. By scoping the data, you
can limit the data to only what you want, and optimize the queries made by
Fogli in the process:</p>

<pre class="code"><span class='comment val'># Assuming we're authenticated (above)</span>
<span class='u identifier id'>u</span> <span class='assign token'>=</span> <span class='Fogli constant id'>Fogli</span><span class='colon2 op'>::</span><span class='User constant id'>User</span><span class='lbrack token'>[</span><span class='symbol val'>:me</span><span class='rbrack token'>]</span>

<span class='comment val'># We just want feed times since yesterday, and we're only interested</span>
<span class='comment val'># in 10 of them:</span>
<span class='u identifier id'>u</span><span class='dot token'>.</span><span class='feed identifier id'>feed</span><span class='dot token'>.</span><span class='since identifier id'>since</span><span class='lparen token'>(</span><span class='string val'>&quot;yesterday&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='limit identifier id'>limit</span><span class='lparen token'>(</span><span class='integer val'>10</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='item identifier id'>item</span><span class='bitor op'>|</span>
  <span class='comment val'># Do something with the item</span>
<span class='end end kw'>end</span>

<span class='comment val'># Another example: We want to access all the user's friends, but only</span>
<span class='comment val'># want their first and last name:</span>
<span class='u identifier id'>u</span><span class='dot token'>.</span><span class='friends identifier id'>friends</span><span class='dot token'>.</span><span class='fields identifier id'>fields</span><span class='lparen token'>(</span><span class='symbol val'>:first_name</span><span class='comma token'>,</span> <span class='symbol val'>:last_name</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='friend identifier id'>friend</span><span class='bitor op'>|</span>
   <span class='p identifier id'>p</span> <span class='dstring node'>&quot;Friend: #{friend.first_name} #{friend.last_name}&quot;</span>
<span class='end end kw'>end</span>
</pre>

<h2>Lazy Loading and Caching</h2>

<p>Everything in Fogli is lazy-loaded. This means that data is loaded on
demand and no queries are made until you need the data. So, how many
HTTP queries do you think <code>User[:me].feed.since("yesterday")</code> takes?
Since no property was ever access on the user, only 1 query is used
(to get the <code>feed</code> items since yesterday).</p>

<p>Additionally, once the data is loaded, it is cached to minimize the
number of queries needed:</p>

<pre class="code"><span class='comment val'># This is also only one query, the entire script, even though the</span>
<span class='comment val'># items are accessed 4 times.</span>
<span class='items identifier id'>items</span> <span class='assign token'>=</span> <span class='Fogli constant id'>Fogli</span><span class='colon2 op'>::</span><span class='User constant id'>User</span><span class='lbrack token'>[</span><span class='symbol val'>:me</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='feed identifier id'>feed</span><span class='dot token'>.</span><span class='since identifier id'>since</span><span class='lparen token'>(</span><span class='string val'>&quot;yesterday&quot;</span><span class='rparen token'>)</span>
<span class='items identifier id'>items</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
<span class='items identifier id'>items</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
<span class='items identifier id'>items</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
<span class='items identifier id'>items</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
</pre></div></div>
    
    <div id="footer">
  Generated on Tue Jun  8 19:49:13 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool">yard</a>
  0.5.5 (ruby-1.8.7).
</div>

  </body>
</html>